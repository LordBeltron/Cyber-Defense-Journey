# üõ°Ô∏è NIST Incident Response Instructions (Rev. 3 Aligned)
**Author:** Zac Belchar  
**Scope:** Practical, SOC-ready instructions aligned to **NIST SP 800-61 Rev. 3** (‚ÄúIncident Response Recommendations and Considerations for Cybersecurity Risk Management‚Äù), integrated with SIEM/SOAR workflows.

---

## üî≠ 0) Purpose & Audience
This guide provides a compact, actionable playbook for a small SOC or solo analyst:

- What to do **before**, **during**, and **after** an incident.  
- Concrete steps, commands, and queries (Windows + Splunk examples).  
- Documentation templates to demonstrate process maturity.

---

## üß± 1) NIST IR Lifecycle (Rev. 3)
NIST emphasizes a **continuous, risk-managed** approach that ties into the CSF (Identify / Protect / Detect / Respond / Recover).

1. **Preparation**  
   - Policies, roles, contacts, tooling readiness (SIEM, SOAR, EDR, ticketing).  
   - Runbooks, communications plan, evidence handling procedures, and tabletop exercises.

2. **Detection & Analysis**  
   - Centralize telemetry (logs, alerts).  
   - Triage ‚Üí validate ‚Üí scope ‚Üí classify (incident vs. event).  
   - Use threat intelligence + MITRE ATT&CK mapping.

3. **Containment, Eradication, Recovery**  
   - Short-term containment and evidence capture.  
   - Remove root cause, patch/harden systems.  
   - Recover to a known-good state and enhance monitoring.

4. **Post-Incident Activity (Continuous Improvement)**  
   - Capture lessons learned, identify control gaps, and update detections/playbooks.  
   - Track metrics (MTTD/MTTR, false-positive rates).

---

## üß≠ 2) Roles & Responsibilities
| Role | Primary Duties | Backup |
|------|----------------|--------|
| IR Lead | Declare severity, approve containment, handle external comms | Deputy / On-call L2 |
| Tier 1 Analyst | Validate alerts, open tickets, collect initial evidence | Any analyst |
| Tier 2/3 Investigator | Hunt, scope, plan containment, manage evidence | IR Lead |
| Communications | Stakeholder updates, legal/PR coordination | IR Lead |
| Forensics | Imaging, chain of custody, timeline reconstruction | Investigator |

---

## üö¶ 3) Severity & Classification
| Severity | Definition | Initial Actions |
|-----------|-------------|-----------------|
| **SEV-1** | Ongoing compromise, business-critical impact | Isolate hosts, activate IR war room, hourly updates |
| **SEV-2** | Confirmed compromise, limited scope | Contain, daily updates, perform forensic capture |
| **SEV-3** | Suspected compromise / anomaly | Increase monitoring, perform targeted hunting |
| **SEV-4** | False positive / benign event | Tune detections, close with analyst notes |

**Classification Tags:** `Phishing`, `Malware`, `Ransomware`, `Data Exfil`, `Privilege Abuse`, `C2`, `Web App`, `Insider`, `Supply Chain`

---

## üß∞ 4) Preparation Checklist
- [ ] SIEM connected to key sources: Windows, Sysmon, Firewall, EDR, DNS, Proxy  
- [ ] SOAR playbooks tested: IP/domain enrichment, host isolation, mailbox purge  
- [ ] Ticketing templates ready (IR, Problem, Change)  
- [ ] Contact trees (IT, Legal, HR, PR) current and verified  
- [ ] Evidence handling SOP and chain-of-custody form in place  
- [ ] Tabletop exercise completed within last 6 months  

---

## üîé 5) Detection & Triage (Quick Flow)
1. **Acknowledge alert** ‚Üí log ticket, stamp time/owner  
2. **Validate** ‚Üí false positive? context? change window?  
3. **Scope** ‚Üí what hosts/users/credentials are impacted? lateral movement?  
4. **Classify + Set SEV** ‚Üí escalate to IR Lead if SEV-2 or higher  
5. **Decide:** monitor vs. contain  

**Key triage questions:**
- What changed before the alert?  
- Is this isolated or widespread?  
- Any unusual outbound traffic or data exfil?

---

## üß™ 6) Practical Queries (Windows + Splunk SPL)

### ü™ü Windows (PowerShell)
```powershell
# Failed logons (4625)
Get-WinEvent -FilterHashtable @{LogName='Security'; Id=4625} -MaxEvents 100 |
  Select TimeCreated, Id, ProviderName, @{n='User';e={$_.Properties[5].Value}}, Message

# PowerShell Script Block Logging (4104)
Get-WinEvent -FilterHashtable @{LogName='Microsoft-Windows-PowerShell/Operational'; Id=4104} |
  Select TimeCreated, Id, Message

# Local admins
net localgroup administrators

# Running processes (quick look)
Get-Process | Sort-Object CPU -desc | Select -First 15 Name, Id, CPU

</details>

---

<a id="sec11"></a>
<details>
<summary><strong>üìù 11) Incident Report Template</strong> &nbsp; <img src="https://img.shields.io/badge/Reporting-Required-lightgrey?style=flat-square" /></summary>

üìÑ **Incident Report PDF:**  
[`./Templates/Incident_Report_Template.pdf`](./Templates/Incident_Report_Template.pdf)


</details>

---

<a id="sec12"></a>
<details>
<summary><strong>üß≠ 12) ATT&CK Mapping (Quick Reference)</strong> &nbsp; <img src="https://img.shields.io/badge/Framework-MITRE%20ATT&CK-0f4c81?style=flat-square" /></summary>

| Tactic | Examples |
|--------|-----------|
| Initial Access | T1566 Phishing, T1190 Exploit Public-Facing App |
| Execution | T1059 PowerShell, T1106 Native APIs |
| Persistence | T1547 Boot/Logon Autostart, T1053 Scheduled Task |
| Privilege Escalation | T1548 Abuse Elevation Control |
| Defense Evasion | T1562 Disable Security Tools |
| Discovery | T1087 Account Discovery |
| Lateral Movement | T1021 Remote Services |
| Command & Control | T1071 HTTPS/DNS |
| Collection/Exfiltration | T1041 Exfil Over C2 |

</details>

---

<a id="sec13"></a>
<details>
<summary><strong>üß© 13) CMMC / NIST 800-171 Tie-ins</strong> &nbsp; <img src="https://img.shields.io/badge/CMMC-Level%202-blue?style=flat-square" /></summary>

| Control Family | Purpose | Example |
|----------------|----------|---------|
| IR.L2-3.6.x | Incident Response Planning | Runbooks, lessons learned |
| AU.L2-3.3.x | Audit & Accountability | Log retention, review cycles |
| AC / IA / CM | Access, Identity, Config | Disable accounts, enforce MFA, patching |

</details>

---

<a id="sec14"></a>
<details>
<summary><strong>üìä 14) Metrics & Continuous Improvement</strong> &nbsp; <img src="https://img.shields.io/badge/Analytics-Operational-blue?style=flat-square" /></summary>

Track monthly:
- **MTTD / MTTR** ‚Äì detection & response times  
- **Incidents by class/severity**  
- **False positive rate per rule**  
- **Playbook runtime**  
- **Top 5 tuned detections**  

</details>

---

<a id="sec15"></a>
<details>
<summary><strong>‚úÖ 15) Quick ‚ÄúGo Bag‚Äù Checklist</strong> &nbsp; <img src="https://img.shields.io/badge/Field%20Guide-Ready-brightgreen?style=flat-square" /></summary>

**When in doubt:**

1. Confirm alert ‚Üí open ticket w/ timestamp & owner  
2. Snapshot scope ‚Üí assign SEV ‚Üí inform IR Lead  
3. Contain IOCs ‚Üí preserve evidence  
4. Eradicate ‚Üí patch ‚Üí reset credentials  
5. Recover ‚Üí validate clean telemetry  
6. Report ‚Üí lessons learned ‚Üí tune detections  

</details>
